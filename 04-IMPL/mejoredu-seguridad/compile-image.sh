#!/bin/sh
echo "Script executed from: ${PWD}"
BASEDIR=$(dirname $0)
# Execute: ./mvnw package -Dquarkus.package.type=legacy-jar
# From BASEDIR
./mvnw package -Dquarkus.package.type=legacy-jar
sudo docker build -f src/main/docker/Dockerfile.legacy-jar -t mx-queretaro-1.ocir.io/axd4fuzohfaf/mejoredu-sipse-seguridad-cors .
sudo docker push mx-queretaro-1.ocir.io/axd4fuzohfaf/mejoredu-sipse-seguridad-cors

# docker run --name=sipse-ms-seguridad -d --network sipse-app --network-alias sipse-ms-seguridad --add-host host.docker.internal:host-gateway -p 9000:9000 -e SIPSE_DB_DRIVE=postgresql -e SIPSE_DB_PORT=5432 -e SIPSE_DB_NAME=mejoreduDB -e SIPSE_DB_USER=admin -e SIPSE_DB_PASS=Mejoredu23# -e SIPSE_DB_HOST=host.docker.internal -e SIPSE_LDAP_PRINCIPAL=sipse -e SIPSE_LDAP_HOST=host.docker.internal -e SIPSE_LDAP_PASS=Mejorsip2024 -e SIPSE_ALF_UUID_PLANEACION=fbf0b143-2a69-4b9b-803d-d779d7bc241f -e SIPSE_ALF_UUID_SEGUIMIENTO=a21771fa-0bf2-4c87-a48d-c74057b1d762 -e SIPSE_ALF_UUID_EVALUACION=ec367ec6-242d-44d0-8593-4b483588394d -e SIPSE_ALF_UUID_REPORTES=069ddfa7-c4bc-4d1d-9f90-d1ab27667c59 -e SIPSE_ALF_UUID_CONFIGURACION=50797c92-d0ba-4259-8025-d12ac5e3873e -e SIPSE_ALF_ID_TOKEN=c2lwc2V1c2VyOnNpcHNlMjAyNGsw -e SIPSE_ALF_SERVER_URL=http://172.18.0.148:8080/alfresco/api/-default-/public/alfresco/versions/1 -e SIPSE_ALF_UUID_AYUDA=918c4afd-abd8-4c4b-847b-cd80f69cb756 -e SIPSE_ALF_UUID_APOYO=86f8b380-ef8b-44f6-afbc-0752adde5173 -e SIPSE_ALF_UUID_NORMATIVIDAD=507ec2de-10a0-4e4c-9f1f-2c4846215cf1 -e TZ=America/Mexico_City mx-queretaro-1.ocir.io/axd4fuzohfaf/mejoredu-sipse-seguridad-cors:latest

# Reset container
# docker pull mx-queretaro-1.ocir.io/axd4fuzohfaf/mejoredu-sipse-seguridad-cors && docker stop sipse-ms-seguridad && docker rm sipse-ms-seguridad && docker run --name=sipse-ms-seguridad -d --network sipse-app --network-alias sipse-ms-seguridad --add-host host.docker.internal:host-gateway -p 9000:9000 -e SIPSE_DB_DRIVE=postgresql -e SIPSE_DB_PORT=5432 -e SIPSE_DB_NAME=mejoreduDB -e SIPSE_DB_USER=admin -e SIPSE_DB_PASS=Mejoredu23# -e SIPSE_DB_HOST=host.docker.internal -e SIPSE_LDAP_PRINCIPAL=sipse -e SIPSE_LDAP_HOST=host.docker.internal -e SIPSE_LDAP_PASS=Mejorsip2024 -e SIPSE_ALF_UUID_PLANEACION=fbf0b143-2a69-4b9b-803d-d779d7bc241f -e SIPSE_ALF_UUID_SEGUIMIENTO=a21771fa-0bf2-4c87-a48d-c74057b1d762 -e SIPSE_ALF_UUID_EVALUACION=ec367ec6-242d-44d0-8593-4b483588394d -e SIPSE_ALF_UUID_REPORTES=069ddfa7-c4bc-4d1d-9f90-d1ab27667c59 -e SIPSE_ALF_UUID_CONFIGURACION=50797c92-d0ba-4259-8025-d12ac5e3873e -e SIPSE_ALF_ID_TOKEN=c2lwc2V1c2VyOnNpcHNlMjAyNGsw -e SIPSE_ALF_SERVER_URL=http://172.18.0.148:8080/alfresco/api/-default-/public/alfresco/versions/1 -e SIPSE_ALF_UUID_AYUDA=918c4afd-abd8-4c4b-847b-cd80f69cb756 -e SIPSE_ALF_UUID_APOYO=86f8b380-ef8b-44f6-afbc-0752adde5173 -e SIPSE_ALF_UUID_NORMATIVIDAD=507ec2de-10a0-4e4c-9f1f-2c4846215cf1 -e TZ=America/Mexico_City mx-queretaro-1.ocir.io/axd4fuzohfaf/mejoredu-sipse-seguridad-cors:latest
